---
title: "eePlumB User Guide"
subtitle: "Earth Engine Plumes and Blooms (eePlumB) idenfitication tutorial"
output: 
  html_document:
    theme: yeti
---

# {.tabset .tabset-fade .tabset-pills}

## About this project

**Why identify plumes and blooms?** Cyanobacteria blooms are one of the most significant management challenges in the Great Lakes today. Recurring blooms of varying toxicity are commonly observed in four of the Great Lakes, and the fifth, Lake Superior, has experienced intermittent nearshore blooms since 2012. The recent advent of cyanobacterial blooms in Lake Superior is disconcerting, given the highly valued, pristine water quality of the large lake. Many fear the appearance of blooms portend a very different future for Lake Superior. As a public resource, the coastal water quality of Lake Superior has tremendous economic, public health, and environmental value, and therefore, preventing cyanobacterial blooms in Lake Superior is a high-priority management challenge.

Lake Superior is a large lake, and relying on human observations of blooms restricts observations to near-shore locations. Remote sensing has the potential to catalog spatial and temporal extent of surface blooms. In this project, we are attempting to use optical imagery from Lake Superior to delineate surface plumes (sediment) and blooms (algae). It is likely that these two surface features occur at the same time (i.e a rainstorm may lead to a sediment plume from a river and subsequently an algal boom). 

To train computer algorithms to detect these features in satellite images we need a training dataset. That's where we need your help! In this exercise, we ask you to participate in identify changes in surface conditions in the western arm of Lake Superior. All you need is a computer and your eyes.

We will be using Google Earth Engine (GEE) for this project and instructions on how to use this software are detailed below. 

## Initial setup

If this is your first time using GEE and this classification workflow, please follow the tutorial below to have your account and permissions setup appropriately. You should only need to do this step once.

You can also watch the first 2.5 minutes of [this video](https://youtu.be/QXJf9IAF1z4) to visually walk through the setup instructions. Note that the video was originally created for the "GROD workflow", which was the foundation for the workflow here, and you may need to substitute information that is specific for this project.

1. Sign up for Google Earth Engine: <https://earthengine.google.com/>. If you don't have an affiliation, you can put University of Wisconsin-Madison.
2. Set up a shareable Google Drive Folder
    a. Using your Google account (the same one you made your Google Earth Engine account with), open up your [Google drive](https://drive.google.com/drive/my-drive) and make a new folder in your drive to store data from the project. Please include your name in the name of the folder, ex. 'FirstnameLastnameData'
    b. Once the folder is created, please share it with the group. To do this, you can right click on the folder and click 'share.' Next, click 'get shareable link' in the top right corner, and set link sharing to 'Anyone with the link can edit.' Lastly, click 'copy link,' and paste the link in this [Google Sheets document](https://docs.google.com/spreadsheets/d/1J_jvedUA3fDjD4EAYYUe-bmEszaDJWjTzlbqJJN6MXE/edit#gid=0) alongside your name.

```{r, echo=FALSE, out.width = '60%'}
knitr::include_graphics("www/images/newfolder.png")
```

```{r, echo=FALSE, out.width = '50%'}
knitr::include_graphics("www/images/sharefolder.png")
```

## What are we ID-ing?

flow chart & examples

## How to label images in GEE, Part 1

The purpose of this step is to walk you through how to setup a script in GEE to be able to open an image before you actually label it. You will need to do this process before each new mission-date combination you are classifying.

1. Go to the project [Github page.](https://github.com/rossyndicate/Superior-Plume-Bloom/tree/main/eePlumB/1_user_interface_script) 

2. Copy and paste the appropriate `.js` script into a blank [Google Earth Engine editor](https://code.earthengine.google.com/). 

* If this is your first time through the tutorial, you will be working with the validation script: [`eePlumB_validation.js`](https://github.com/rossyndicate/Superior-Plume-Bloom/blob/5e9d0cd1ad435aa3bdb2f0d2b41c026c0f57c8ab/eePlumB/1_user_interface_script/eePlumB_validation). The purpose of this step is to have you go through the full process of classifying a few images for practice and to provide us with data to see how similarly all our volunteers classify a range of conditions. We hope that the examples below will help guide everyone to classify conditions similarly, but we understand that there will be variation as there is a level of subjectivity in this process. 
* If you have already completed the tutorial once using the validation script, you have made it to the main classification workflow and will be working with the classification script: [`eePlumB_classification.js`](LINK ME)

```{r, echo=FALSE, out.width = '80%'}
knitr::include_graphics("www/images/copy.png")
```

```{r, echo=FALSE, out.width = '80%'}
knitr::include_graphics("www/images/newscript.png")
```

```{r, echo=FALSE, out.width = '80%'}
knitr::include_graphics("www/images/paste.png")
```

3. To prepare the feature categories, you will need to convert them to import records. You can do this by hovering over the first few lines of code `var openWater =...` and GEE will prompt you to import these records. Click convert to do so.

```{r, echo=FALSE, out.width = '100%'}
knitr::include_graphics("www/images/import.png")
```

4. Write your initials at the top of the script and hit the ‘Save’ button. 

* If you haven't done this before, you will be directed to a pop up which will ask you to create your home folder. You won't be able to change this folder name in the future, so we recommend you Write your name or a nickname/email and then hit 'continue.' 
* Next, you will need to choose a name for this script. You will be saving a new script for each unique classification activity. Please take note the name of the file you save as you will need this to go back and continue your work.
** If this is your first time through the workflow, you are on the validation step and should name the file `eePlumB_[YOUR INITIALS]_validation`.
** If you are working on the actual classification steps, you should name the file `eePlumB_[YOUR INITIALS]_[MISSION]_[DATE]` based on the assigned mission-date combination you are currently working through.

```{r, echo=FALSE, out.width = '100%'}
knitr::include_graphics("www/images/savescript.png")
```

```{r, echo=FALSE, out.width = '80%'}
knitr::include_graphics("www/images/CreateHomeFolder.jpg")
```

5. Verify that you are in the script that you just saved, then hit ‘Run’ at the center top of your screen.

```{r, echo=FALSE, out.width = '100%'}
knitr::include_graphics("www/images/run.png")
```

Now that you have the script running, you are ready to add labels. Head to the next section, `How to label images in GEE, Part 2`!

## How to label images in GEE, Part 2

The purpose of this step is to teach you how to use our Google Earth Engine framework to classify images. Hopefully, this section is an easy reference if you need a refresher in the future. Note that this step assumes you have already done Part 1 for the current set of images (either validation or for the specific mission-date you have been assigned).

### Adding labels

1. Check that you have the appropriate geometry categories by hovering over `Geometry Imports` in the map area of GEE. If you don't see a list of sediment and bloom types, then you should revisit Part 1 and follow those instructions carefully.

```{r, echo=FALSE, out.width = '80%'}
knitr::include_graphics("www/images/categories.png")
```

2. When you see a new feature in the image that you would like to label, you will need to click on the top left geometry bar and select the point geometry icon.

```{r, echo=FALSE, out.width = '50%'}
knitr::include_graphics("www/images/addmarker.png")
```

3. Change the category to the type of feature that you are labeling by hovering over `openWater` (it just chooses the first category by default) and clicking the name of the category you want.

4. Next, click on the map to add a point of this type. 

```{r, echo=FALSE, out.width = '80%'}
knitr::include_graphics("www/images/addpoint.png")
```

5. Continue adding points in this category by clicking the pixel on the map that you want to label. Zoom in or out and scroll (by clicking and dragging) as needed. 

6. When you are done, click `Exit` next to where it says "Point drawing". If you want to start adding points again, simply go back to Step 2 and repeat.

```{r, echo=FALSE, out.width = '80%'}
knitr::include_graphics("www/images/endpoint.png")
```

### Editing

1. If you have made a mistake, click on the hand icon at the top left-hand corner of the map (see the red circle on the figure below). Next, click on the point you dislike. Then, you can drag to a new location or hit delete to remove the point. If you moved the point, hit `Exit` to stop the editing session. 

2. To resume adding points, go back to Step 2 in the previous section.


```{r, echo=FALSE, out.width = '60%'}
knitr::include_graphics("www/images/editing.png")
```

### Finishing up the labeling

When you have completed labeling your image, ... 

### Useful keyboard shortcuts

Here are some useful shortcuts if you are a keyboard rather than mouse person.

```{r, echo=FALSE, out.width = '40%'}
knitr::include_graphics("www/images/keyboard.png")
```
